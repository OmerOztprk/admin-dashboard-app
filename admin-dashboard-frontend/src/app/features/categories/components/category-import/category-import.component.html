<div class="container-fluid mt-4">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h4 class="mb-0">Excel'den Kategori İçe Aktar</h4>
      <button class="btn btn-outline-secondary btn-sm" routerLink="/categories">
        <i class="bi bi-arrow-left me-1"></i> Geri Dön
      </button>
    </div>
    
    <div class="card-body">
      <div class="alert alert-info mb-4">
        <div class="d-flex align-items-center">
          <i class="bi bi-info-circle-fill me-2 fs-5"></i>
          <div>
            <h5 class="mb-1">İçe Aktarma Talimatları</h5>
            <p class="mb-1">Excel dosyanız şu sütunları içermelidir: category_name, description, parent_id (opsiyonel)</p>
            <p class="mb-0">
              <button type="button" class="btn btn-sm btn-outline-primary" (click)="downloadTemplate()">
                <i class="bi bi-download me-1"></i> Excel Şablonu İndir
              </button>
            </p>
          </div>
        </div>
      </div>
      
      <div class="mb-4">
        <div class="mb-3">
          <label for="fileInput" class="form-label">Excel Dosyası Seçin (.xlsx)</label>
          <input 
            type="file" 
            class="form-control" 
            id="fileInput" 
            accept=".xlsx, .xls" 
            (change)="onFileSelected($event)"
            [disabled]="isUploading"
          >
        </div>
        
        <div class="d-flex justify-content-end">
          <button 
            type="button" 
            class="btn btn-primary" 
            [disabled]="!selectedFile || isUploading" 
            (click)="uploadFile()"
          >
            <i class="bi bi-upload me-1"></i>
            {{ isUploading ? 'Yükleniyor...' : 'Dosyayı Yükle ve İçe Aktar' }}
          </button>
        </div>
      </div>
      
      <!-- Yükleme İlerleme Durumu -->
      <div *ngIf="isUploading" class="mb-4">
        <label class="form-label">Yükleme Durumu: {{ uploadProgress }}%</label>
        <div class="progress">
          <div 
            class="progress-bar" 
            role="progressbar" 
            [style.width.%]="uploadProgress" 
            [attr.aria-valuenow]="uploadProgress" 
            aria-valuemin="0" 
            aria-valuemax="100"
          ></div>
        </div>
      </div>
      
      <!-- Hata -->
      <div *ngIf="uploadError" class="alert alert-danger">
        <i class="bi bi-exclamation-triangle-fill me-2"></i> {{ uploadError }}
      </div>
      
      <!-- Başarılı Sonuç -->
      <div *ngIf="uploadSuccess && importResults" class="mt-4">
        <div class="alert alert-success">
          <i class="bi bi-check-circle-fill me-2"></i> Dosya başarıyla içe aktarıldı!
        </div>
        
        <div class="card mt-3">
          <div class="card-header bg-light">İçe Aktarma Sonuçları</div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-4">
                <div class="card text-white bg-success mb-3">
                  <div class="card-body text-center">
                    <h5 class="card-title">Eklenen</h5>
                    <p class="display-4">{{ importResults.added || 0 }}</p>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="card text-white bg-warning mb-3">
                  <div class="card-body text-center">
                    <h5 class="card-title">Güncellenen</h5>
                    <p class="display-4">{{ importResults.updated || 0 }}</p>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="card text-white bg-danger mb-3">
                  <div class="card-body text-center">
                    <h5 class="card-title">Hatalı</h5>
                    <p class="display-4">{{ importResults.failed || 0 }}</p>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Hata Listesi -->
            <div *ngIf="importResults.errors && importResults.errors.length > 0" class="mt-3">
              <h5>Hata Detayları</h5>
              <ul class="list-group">
                <li class="list-group-item" *ngFor="let error of importResults.errors">
                  <strong>Satır {{ error.row || '?' }}</strong>: {{ error.message }}
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card-footer text-end">
      <a routerLink="/categories" class="btn btn-outline-primary">
        <i class="bi bi-list me-1"></i> Kategori Listesine Git
      </a>
    </div>
  </div>
</div>